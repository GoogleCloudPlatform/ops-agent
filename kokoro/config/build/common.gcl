// Common configuration for Linux Ops Agent builds.

import '../utils/functions.gcl' as functions

template config build = {
  build_file = 'unified_agents/kokoro/scripts/build/build_package.sh'

  params {
    package_format = null

    environment {
      PKGFORMAT = package_format
    }

    keystore_keys = []
    artifacts = ["**/result/**", "**/out/**"]
  }

  before_action = [functions.fetch_keystore(params.keystore_keys)]

  action = [
    {
      define_artifacts = {
        regex = params.artifacts
      }
    },
  ]

  env_vars = functions.environment_variables(params.environment)
}

template config windows_build = build {
  build_file = 'unified_agents/kokoro/scripts/build/build_package.bat'
}
