{{$PKG_VERSION := printf "%s@1" .PKG_VERSION -}}
{{$ARCH := .ARCH -}}
{{$GOOS := .GOOS -}}
{{$GOARCH := .GOARCH -}}
{{$INSTALL_DIR := or (.INSTALL_DIR) "<ProgramFiles>/Google/Cloud Operations/Ops Agent" -}}
{{$DATA_DIR := or (.DATA_DIR) "<ProgramData>/Google/Cloud Operations/Ops Agent" -}}
{
  "name": "google-cloud-ops-agent",
  "version": "{{$PKG_VERSION}}",
  "arch": "{{$ARCH}}",
  "authors": "Google Cloud Ops Agent",
  "license": "http://www.apache.org/licenses/LICENSE-2.0",
  "description": "The Google Cloud Ops Agent collects metrics and logs from the system.",
  "files": {
    "bin/fluent-bit.exe": "{{$INSTALL_DIR}}/bin/fluent-bit.exe",
    "bin/fluent-bit.dll": "{{$INSTALL_DIR}}/bin/fluent-bit.dll",
    "bin/google-cloud-metrics-agent_{{$GOOS}}_{{$GOARCH}}.exe": "{{$INSTALL_DIR}}/bin/google-cloud-metrics-agent_{{$GOOS}}_{{$GOARCH}}.exe",
    "bin/google-cloud-ops-agent.exe": "{{$INSTALL_DIR}}/bin/google-cloud-ops-agent.exe",
    "config/config.yaml": "{{$INSTALL_DIR}}/config/config.yaml"
  },
  "install": {
    "path": "pkg/goo/maint.ps1",
    "args": ["-InstallDir:\"{{$INSTALL_DIR}}\"", "-Action:install"]
  },
  "uninstall": {
    "path": "pkg/goo/maint.ps1",
    "args": ["-InstallDir:\"{{$INSTALL_DIR}}\"", "-Action:uninstall"]
  },
  "sources": [{
      "include": [
        "bin/fluent-bit.exe",
        "bin/fluent-bit.dll",
        "bin/google-cloud-metrics-agent_{{$GOOS}}_{{$GOARCH}}.exe",
        "bin/google-cloud-ops-agent.exe",
        "config/config.yaml",
        "pkg/goo/maint.ps1"
      ]
  }]
}
