minimum_supported_agent_version:
  metrics: 2.10.0
  logging: 2.10.0
expected_metrics:
- type: agent.googleapis.com/iis/current_connections
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: agent.googleapis.com/iis/network/transferred_bytes_count
  value_type: INT64
  kind: CUMULATIVE
  monitored_resource: gce_instance
  labels:
    direction: .*
- type: agent.googleapis.com/iis/new_connection_count
  value_type: INT64
  kind: CUMULATIVE
  monitored_resource: gce_instance
  labels: {}
- type: agent.googleapis.com/iis/request_count
  value_type: INT64
  kind: CUMULATIVE
  monitored_resource: gce_instance
  labels:
    http_method: .*
  representative: true
expected_logs:
- log_name: iis_access
  fields:
  - name: httpRequest.serverIp
    value_regex: "127.0.0.1:80"
    type: string
    description: "The server's IP and port that was requested"
  - name: httpRequest.remoteIp
    value_regex: "127.0.0.1"
    type: string
    description: "IP of the client that made the requestb v"
  - name: httpRequest.requestUrl
    value_regex: "/forbidden?something=something"
    type: string
    description: "Request URL (typically just the path part of the URL)"
  - name: httpRequest.protocol
    value_regex: "HTTP/1.1"
    type: string
    description: "Protocol used for the request"
  - name: httpRequest.requestMethod
    value_regex: GET"
    type: string
    description: "HTTP method"
  - name: httpRequest.status
    value_regex: 404
    type: number
    description: "HTTP status code"
  - name: httpRequest.userAgent
    value_regex: "curl/.*"
    type: string
    description:  "Contents of the `User-Agent` header"
  - name: httpRequest.referer
    type: string
    description:  "Contents of the `Referer` header"
  - name: jsonPayload.sc_substatus
    value_regex: 0
    type: number
    description: "The server's IP and port that was requested"
  - name: jsonPayload.sc_win32_status
    value_regex: 2
    type: number
    description: "The server's IP and port that was requested"
  - name: jsonPayload.time_taken
    value_regex: '\d+'
    type: number
    description: "The length of time that the action took, in milliseconds"
  - name: jsonPayload.user
    type: number
    description: "Authenticated username for the request"