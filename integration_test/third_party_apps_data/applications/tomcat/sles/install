set -e
sudo zypper install -y curl java-11-openjdk
sudo zypper install tomcat -y
sudo cat << EOF | sudo tee /usr/lib/systemd/system/tomcat9.service 
# Systemd unit file for default tomcat
# 
# To create clones of this service:
# DO NOTHING, use tomcat@.service instead.
[Unit]
Description=Apache Tomcat Web Application Container
After=syslog.target network.target
[Service]
TasksMax=576
LimitNOFILE=8192
Type=simple
EnvironmentFile=/etc/tomcat/tomcat.conf
Environment="NAME="
EnvironmentFile=-/etc/sysconfig/tomcat
ExecStart=/usr/lib/tomcat/server start
ExecStop=/usr/lib/tomcat/server stop
SuccessExitStatus=143
User=tomcat
Group=tomcat
Environment="CATALINA_OPTS=-Dcom.sun.management.jmxremote.port=8090 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false"
Environment="JAVA_OPTS=-Djava.awt.headless=true"
[Install]
WantedBy=multi-user.target
EOF

sudo systemctl daemon-reload