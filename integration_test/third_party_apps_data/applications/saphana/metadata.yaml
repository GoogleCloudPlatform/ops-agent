short_name: HANA
long_name: SAP HANA
app_url: "https://www.sap.com/products/hana.html"
description: |-
  The SAP HANA integration collects SAP HANA metrics by querying relevant monitoring views.
configure_integration: |-
  To collect metrics, a monitoring user requires `SELECT` access to the relevant monitoring views. The following sql
  script should create a monitoring role and apply it to a monitoring user if executed by
  a user with sufficient permissions connected to the SAP HANA instance.

  <pre>
  --Create the user
  CREATE RESTRICTED USER otel_monitoring_user PASSWORD <password>;
  --Enable user login
  ALTER USER otel_monitoring_user ENABLE CLIENT CONNECT;
  --Create the monitoring role
  CREATE ROLE OTEL_MONITORING;
  --Grant permissions to the relevant views
  GRANT CATALOG READ TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_BACKUP_CATALOG TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_BLOCKED_TRANSACTIONS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_CONNECTIONS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_CS_ALL_COLUMNS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_CS_TABLES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_DATABASE TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_DISKS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_HOST_RESOURCE_UTILIZATION TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_LICENSES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_RS_TABLES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_COMPONENT_MEMORY TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_MEMORY TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_REPLICATION TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_STATISTICS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_THREADS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_VOLUME_IO_TOTAL_STATISTICS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_WORKLOAD TO OTEL_MONITORING;
  GRANT SELECT ON _SYS_STATISTICS.STATISTICS_CURRENT_ALERTS TO OTEL_MONITORING;
  --Add the OTEL_MONITOR role to the monitoring user
  GRANT OTEL_MONITORING TO otel_monitoring_user;
  </pre>
supported_app_version: ["2.0"]
expected_metrics:
- type: workload.googleapis.com/saphana.connection.count
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels:
    connection_status: .*
  representative: true
expected_logs:
configuration_options:
  metrics:
  - type: saphana
    fields:
    - name: type
      default: null
      description: This value must be saphana.
    - name: endpoint
      default: localhost:30015
      description: The hostname:port used to connect to the saphana instance.
    - name: collection_interval
      default: 60s
      description: A time.Duration value, such as 30s or 5m.
    - name: username
      default: null
      description: The username used to connect to the instance.
    - name: password
      default: null
      description: The password used to connect to the instance.
    - name: insecure
      default: true
      description: Sets whether or not to use a secure TLS connection. If set to false, then TLS is enabled.
    - name: insecure_skip_verify
      default: false
      description: Sets whether or not to skip verifying the certificate. If insecure is set to true, then the insecure_skip_verify value is not used.
    - name: cert_file
      default: null
      description: Path to the TLS certificate to use for mTLS-required connections.
    - name: key_file
      default: null
      description: Path to the TLS key to use for mTLS-required connections.
    - name: ca_file
      default: null
      description: Path to the CA certificate. As a client, this verifies the server certificate. If empty, the receiver uses the system root CA.