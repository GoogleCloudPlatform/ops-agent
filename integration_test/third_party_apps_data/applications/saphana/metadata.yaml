app_url: https://www.sap.com/products/hana.html
configuration_options:
  metrics:
    - fields:
        - default: null
          description: This value must be saphana.
          name: type
        - default: localhost:30015
          description: The hostname:port used to connect to the saphana instance.
          name: endpoint
        - default: 60s
          description: A time.Duration value, such as 30s or 5m.
          name: collection_interval
        - default: null
          description: The username used to connect to the instance.
          name: username
        - default: null
          description: The password used to connect to the instance.
          name: password
        - default: true
          description: Sets whether or not to use a secure TLS connection. If set to false, then TLS is enabled.
          name: insecure
        - default: false
          description: Sets whether or not to skip verifying the certificate. If insecure is set to true, then the insecure_skip_verify value is not used.
          name: insecure_skip_verify
        - default: null
          description: Path to the TLS certificate to use for mTLS-required connections.
          name: cert_file
        - default: null
          description: Path to the TLS key to use for mTLS-required connections.
          name: key_file
        - default: null
          description: Path to the CA certificate. As a client, this verifies the server certificate. If empty, the receiver uses the system root CA.
          name: ca_file
      type: saphana
configure_integration: |-
  To collect metrics, a monitoring user requires `SELECT` access to the relevant monitoring views. The following sql
  script should create a monitoring role and apply it to a monitoring user if executed by
  a user with sufficient permissions connected to the SAP HANA instance.

  <pre>
  --Create the user
  CREATE RESTRICTED USER otel_monitoring_user PASSWORD <password>;
  --Enable user login
  ALTER USER otel_monitoring_user ENABLE CLIENT CONNECT;
  --Create the monitoring role
  CREATE ROLE OTEL_MONITORING;
  --Grant permissions to the relevant views
  GRANT CATALOG READ TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_BACKUP_CATALOG TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_BLOCKED_TRANSACTIONS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_CONNECTIONS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_CS_ALL_COLUMNS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_CS_TABLES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_DATABASE TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_DISKS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_HOST_RESOURCE_UTILIZATION TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_LICENSES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_RS_TABLES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_COMPONENT_MEMORY TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_MEMORY TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_REPLICATION TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_STATISTICS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICE_THREADS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_SERVICES TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_VOLUME_IO_TOTAL_STATISTICS TO OTEL_MONITORING;
  GRANT SELECT ON SYS.M_WORKLOAD TO OTEL_MONITORING;
  GRANT SELECT ON _SYS_STATISTICS.STATISTICS_CURRENT_ALERTS TO OTEL_MONITORING;
  --Add the OTEL_MONITOR role to the monitoring user
  GRANT OTEL_MONITORING TO otel_monitoring_user;
  </pre>
description: The SAP HANA integration collects SAP HANA metrics by querying relevant monitoring views.
expected_logs: null
expected_metrics:
  - kind: CUMULATIVE
    labels:
      rating: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.alert.count
    value_type: INT64
  - kind: GAUGE
    labels: {}
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.backup.latest
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      subtype: data|dict|index|misc
      type: main|delta
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.column.memory.used
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      component: .*
      host: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.component.memory.used
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      status: running|idle|queueing
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.connection.count
    representative: true
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      type: user|system|io_wait|idle
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.cpu.used
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      path: .*
      state: used|free
      usage_type: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.disk.size.current
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      state: used|free
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.host.memory.current
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      state: used|free
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.host.swap.current
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.instance.code_size
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      state: used|free
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.instance.memory.current
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.instance.memory.shared.allocated
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.instance.memory.used.peak
    value_type: INT64
  - kind: GAUGE
    labels:
      product: .*
      system: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.license.expiration.time
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      product: .*
      system: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.license.limit
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      product: .*
      system: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.license.peak
    value_type: INT64
  - kind: GAUGE
    labels:
      host: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.network.request.average_time
    value_type: DOUBLE
  - kind: CUMULATIVE
    labels:
      host: .*
      state: active|pending
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.network.request.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      type: internal|external
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.network.request.finished.count
    value_type: INT64
  - kind: GAUGE
    labels:
      mode: .*
      port: .*
      primary: .*
      secondary: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.replication.average_time
    value_type: DOUBLE
  - kind: CUMULATIVE
    labels:
      mode: .*
      port: .*
      primary: .*
      secondary: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.replication.backlog.size
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      mode: .*
      port: .*
      primary: .*
      secondary: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.replication.backlog.time
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      type: fixed|variable
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.row_store.memory.used
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      schema: .*
      type: main|delta|history_main|history_delta
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.schema.memory.used.current
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      schema: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.schema.memory.used.max
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      schema: .*
      type: read|write|merge
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.schema.operation.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      schema: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.schema.record.compressed.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      schema: .*
      type: main|delta|history_main|history_delta
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.schema.record.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.code_size
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      status: active|inactive
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.memory.compactors.allocated
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.memory.compactors.freeable
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.memory.effective_limit
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
      state: used|free
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.memory.heap.current
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.memory.limit
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
      state: used|free
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.memory.shared.current
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
      type: logical|physical
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.memory.used
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      service: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.stack_size
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      status: active|inactive
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.service.thread.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.transaction.blocked
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      type: update|commit|rollback
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.transaction.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      database: .*
      host: .*
      system: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.uptime
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      path: .*
      type: read|write
      usage_type: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.volume.operation.count
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      path: .*
      type: read|write
      usage_type: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.volume.operation.size
    value_type: INT64
  - kind: CUMULATIVE
    labels:
      host: .*
      path: .*
      type: read|write
      usage_type: .*
    monitored_resource: gce_instance
    type: workload.googleapis.com/saphana.volume.operation.time
    value_type: INT64
long_name: SAP HANA
short_name: HANA
supported_app_version:
  - "2.0"
