set -e

echo "127.0.0.1 $(hostname -s)" | sudo tee -a /etc/hosts

sudo zypper install -y insserv-compat

source /etc/os-release
SUSE_VERSION="${VERSION_ID%%.*}"
case $SUSE_VERSION in
  15)
    sudo zypper install -y erlang rabbitmq-server
    ;;
  12)
    echo -n "suse 12 not supported"
    exit 1
    ;;
  *)
    echo -n "unknown version"
    exit 1
    ;;
esac

sudo systemctl daemon-reload
sudo systemctl enable rabbitmq-server