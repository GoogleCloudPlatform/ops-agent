short_name: AD DS
long_name: Active Directory Domain Services
supported_app_version: ["windows-server-2012-r2", "windows-server-2016", "windows-server-2019"]
description: |-
  Active Directory Domain Services stores information about objects on the network so that administrators and users
  can easily access this information. For more information, see 
  [Microsoft's overview](https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview)
configure_integration: |-
  By default, Active Directory Windows event logs and performance counters are enabled.
restart_after_install: true
configuration_options:
  logs:
  - type: active_directory_ds
    fields:
    - name: type
      default: null
      description: The value must be active_directory_ds.
  metrics:
  - type: active_directory_ds
    fields:
    - name: type
      default: null
      description: The value must be active_directory_ds.
    - name: collection_interval
      default: 60s
      description: A time.Duration value, such as 30s or 5m.
expected_logs:
- log_name: active_directory_ds
  fields:
  - name: jsonPayload.Message
    value_regex: '^Microsoft Active Directory Domain Services startup complete.*'
    type: string
    description: "The log message."
  - name: jsonPayload.RecordNumber
    type: number
    description: "The sequence number of the event log."
  - name: jsonPayload.TimeGenerated
    value_regex: '^\d+-\d+-\d+ \d+:\d+:\d+ [+-]\d{4}$'
    type: string
    description: "A timestamp representing when the record was generated."
  - name: jsonPayload.TimeWritten
    value_regex: '^\d+-\d+-\d+ \d+:\d+:\d+ [+-]\d{4}$'
    type: string
    description: "A timestamp representing when the record was written to the event log."
  - name: jsonPayload.EventID
    type: number
    description: "An ID identifying the type of the event."
  - name: jsonPayload.EventType
    type: string
    description: "The type of event."
  - name: jsonPayload.Qualifiers
    type: number
    description: "A qualifier number that is used for event identification."
  - name: jsonPayload.EventCategory
    type: number
    description: "The category of the event."
  - name: jsonPayload.Channel
    value_regex: '^Directory Service$'
    type: string
    description: "The event log channel where the log was logged."
  - name: jsonPayload.Sid
    type: string
    description: "The security identifier identifying a security principal or security group of the process that logged this message."
  - name: jsonPayload.SourceName
    value_regex: '^NTDS General$'
    type: string
    description: "The source component that logged this message."
  - name: jsonPayload.ComputerName
    type: string
    description: "The name of the computer from which this log originates."
  - name: jsonPayload.Data
    value_regex: '^$'
    type: string
    description: "Extra event-specific data included with the log."
  - name: jsonPayload.StringInserts
    type: "[]string"
    description: "Dynamic string data that was used to construct the log message."
expected_metrics:
- type: workload.googleapis.com/active_directory.ds.bind.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  representative: true
  labels:
    type: server|client
- type: workload.googleapis.com/active_directory.ds.ldap.bind.last_successful.time
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.ldap.bind.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.ldap.client.session.count
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.ldap.search.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.name_cache.hit_rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.notification.queued
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.operation.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels:
    type: read|write|search
- type: workload.googleapis.com/active_directory.ds.replication.network.io
  value_type: INT64
  kind: CUMULATIVE
  monitored_resource: gce_instance
  labels:
    direction: sent|received
    type: compressed|uncompressed
- type: workload.googleapis.com/active_directory.ds.replication.object.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels:
    direction: sent|received
- type: workload.googleapis.com/active_directory.ds.replication.operation.pending
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.replication.property.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels:
    direction: sent|received
- type: workload.googleapis.com/active_directory.ds.replication.sync.object.pending
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.replication.sync.request.count
  value_type: INT64
  kind: CUMULATIVE
  monitored_resource: gce_instance
  labels:
    result: success|schema_mismatch|other
- type: workload.googleapis.com/active_directory.ds.replication.value.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels:
    direction: sent|received
    type: distingushed_names|other
- type: workload.googleapis.com/active_directory.ds.security_descriptor_propagations_event.queued
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
- type: workload.googleapis.com/active_directory.ds.suboperation.rate
  value_type: DOUBLE
  kind: GAUGE
  monitored_resource: gce_instance
  labels:
    type: security_descriptor_propagations_event|search
- type: workload.googleapis.com/active_directory.ds.thread.count
  value_type: INT64
  kind: GAUGE
  monitored_resource: gce_instance
  labels: {}
minimum_supported_agent_version:
  metrics: 2.15.0
  logging: 2.15.0
