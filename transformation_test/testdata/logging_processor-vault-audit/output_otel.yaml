- entries:
  - jsonPayload:
      auth:
        token_type: default
      request:
        id: req-001
        namespace:
          id: root
        operation: update
        path: sys/audit/test
      type: request
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: 2025-08-25T14:00:00.123456789Z
  - jsonPayload:
      message: "{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"time\":\"2025-08-25T14:01:00.987654321Z\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"type\":\"request\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"auth\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"token_type\":\"root\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "},"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"request\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"id\":\"req-002\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"operation\":\"delete\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"namespace\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"id\":\"root\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "},"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"path\":\"sys/secrets/data\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "}"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "}"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      auth:
        token_type: default
      response:
        id: res-001
        status: success
      type: response
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: 2025-08-25T14:02:00.111213141Z
  - jsonPayload:
      message: "{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"time\":\"2025-08-25T14:03:00.999888777Z\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"type\":\"response\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"auth\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"token_type\":\"default\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "},"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"response\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"id\":\"res-002\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"status\":\"failure\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"error\":\"permission denied\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "}"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "}"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      auth:
        token_type: default
      request:
        id: req-003
        namespace:
          id: root
        operation: create
        path: sys/audit/new
      type: request
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: 2025-08-25T14:04:00.222333444Z
  - jsonPayload:
      message: "{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"time\":\"2025-08-25T14:05:00.555666777Z\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"type\":\"request\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"auth\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"token_type\":\"default\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "},"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"request\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"id\":\"req-004\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"operation\":\"update\","
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"namespace\":{"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"id\":\"root\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "},"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "\"path\":\"sys/audit/multi\""
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  - jsonPayload:
      message: "}"
    labels:
      compute.googleapis.com/resource_name: hostname
      logging.googleapis.com/instrumentation_source: agent.googleapis.com/vault_audit
    logName: projects/my-project/logs/my-log-name
    resource:
      labels:
        instance_id: test-instance-id
        zone: test-zone
      type: gce_instance
    timestamp: now
  partialSuccess: true
- collector_errors:
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ' ' looking for beginning of value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character '}' looking for beginning of value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
  - caller: ottl@v0.131.0/parser.go:410
    error: invalid character ':' after top-level value
    level: warn
    msg: failed to execute statement
    otelcol.component.id: transform/logs_transformation__test_my-log-name_1
    otelcol.component.kind: processor
    otelcol.pipeline.id: logs/logs_transformation__test_my-log-name
    otelcol.signal: logs
    resource:
      service.instance.id: test-service-instance-id
      service.name: otelopscol
      service.version: ""
    statement: set(log.cache["__parsed_json"], ParseJSON(log.body["message"])) where (log.body != nil and log.body["message"] != nil)
