
[FILTER]
    Match                 cassandra.cassandra_system
    Multiline.Key_Content message
    Multiline.Parser      cassandra.cassandra_system.123.multiline
    Name                  multiline

[FILTER]
    Key_Name message
    Match    cassandra.cassandra_system
    Name     parser
    Parser   cassandra.cassandra_system.123

[PARSER]
    Format      regex
    Name        cassandra.cassandra_system.123
    Regex       (?<level>[A-Z]+)\s+\[(?<type>[^\]]+)\]\s+(?<time>\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2},\d+)\s+(?<extendedMessage>(?<message>(?:(?<javaClass>[\w\.]+):(?<lineNumber>\d+))?.+)[\S\s]+)
    Time_Format %Y-%m-%d %H:%M:%S,%L
    Time_Key    time
    Types       lineNumber:integer

[MULTILINE_PARSER]
    Name cassandra.cassandra_system.123.multiline
    Type regex
    rule    "start_state"    "[A-Z]+\s+\[[^\]]+\] \d+"    "cont"
    rule    "cont"    "^(?![A-Z]+\s+\[[^\]]+\] \d+)"    "cont"
